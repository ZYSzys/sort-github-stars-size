#!/usr/bin/env node

const ora = require('ora')
const chalk = require('chalk')
const spinner = ora('Sorting...')

const program = require('commander')

program
  .version(require('../package.json').version, '-v, --version')
  .usage('<command> [options]')
  .description(require('../package.json').description)

program.on('--help', function () {
  console.log('  Examples:');
  console.log('');
  console.log('    $ sort-starred-by-size torvalds');
  console.log('    $ sort-starred-by-size ZYSzys');
  console.log('');
})

program
  .arguments('<command>')
  .option('-lang, --language', 'sort by a specific language')
  .action((cmd) => {
    spinner.start()
    require('..')(cmd, (err, repos) => {
      spinner.stop()
      console.log(err || repos.map(function(c) {
        return `${c.html_url} => ` + chalk.red(`${c.size}`) + `kb`
      }).join("\n"))
    })
  })

program.parse(process.argv)

if (!program.args.length) program.help();
